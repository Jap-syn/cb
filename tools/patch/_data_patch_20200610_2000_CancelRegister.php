<?php
chdir(dirname(__DIR__));

// Setup autoloading
require 'init_autoloader.php';

setlocale( LC_ALL, 'ja_JP.UTF-8' );
ini_set( 'default_charset', 'UTF-8' );
mb_internal_encoding( 'UTF-8' );
mb_http_output('UTF-8');
mb_regex_encoding( 'UTF-8' );

ini_set( 'max_execution_time', 0 );


use Coral\Base\Application\BaseApplicationAbstract;
use Coral\Base\BaseLog;
use Zend\Db\Adapter\Adapter;
use Zend\Config\Reader\Ini;
use models\Table\TableUser;
use models\Logic\LogicCancel;
use models\Logic\OrderCancelException;


/**
 * アプリケーションクラスです。
 *
 */
class Application extends BaseApplicationAbstract {
    protected $_application_id = 'tools-CancelRegister-batch';

    /**
     * Application の唯一のインスタンスを取得します。
     *
     * @static
     * @access public
     * @return Application
     */
    public static function getInstance() {
        if( self::$_instance === null ) {
            self::$_instance = new self();
        }

        return self::$_instance;
    }

    /**
     * Application の新しいインスタンスを初期化します。
     *
     * @ignore
     * @access private
     */
    private function __construct() {
        parent::init();
    }

    /**
     * @var Adapter
     */
    public $dbAdapter;

    /**
     * @var BaseLog
     */
    public $logger;


    /**
     * アプリケーションを実行します。
     *
     * @access public
     */
    public function run() {
        $exitCode = 1;

        try {

            // 実行確認
            echo "Run the Cancel batch. Is it OK?(Y/N)";
            $yn = trim(fgets(STDIN));
            if (strtoupper($yn) != 'Y') {
                echo "It has stopped the execution. ";
                exit(0);
            }

            // iniファイルから設定を取得
            $configPath = __DIR__ . '/../module/cbadmin/config/config.ini';

            // データベースアダプタをiniファイルから初期化します
            $data = array();
            if (file_exists($configPath))
            {
                $reader = new Ini();
                $data = $reader->fromFile($configPath);
            }
            $this->dbAdapter = new Adapter($data['database']);

            // ログ設定の読み込み
            $logConfig = $data['log'];
            // 標準ログクラス初期化
            $this->logger = BaseLog::createFromArray( $logConfig );
$this->logger->info('_data_patch_20200610_2000_CancelRegister.php start');

            $globalConfig = include __DIR__ . '/../config/autoload/global.php';
            // 接続時間を設定する
            $rds_session_timezone = $globalConfig['RDS_SESSION_TIMEZONE'];
            if (isset($rds_session_timezone)) {
                $this->dbAdapter->query('SET SESSION time_zone = :time_zone')->execute(array(':time_zone'=>$rds_session_timezone));
            }

            // 設定をシステムプロパティテーブルから読み込み
            $apinfo = $this->getApplicationiInfo($this->dbAdapter, 'cbadmin');
            // iniファイルの内容をマージ
            $data = array_merge($data, $apinfo);

            // ユーザーID取得
            $mdlu = new TableUser($this->dbAdapter);
            $userId = $mdlu->getUserId(TableUser::USERCLASS_SYSTEM, TableUser::SEQ_BATCH_USER);

            $this->dbAdapter->getDriver()->getConnection()->beginTransaction();


            // ------------------------------------------------------------------------->
            // 対象の定義
            $target = array(
'AK43911773',
'AK43150064',
'AK42539305',
'AK44554000',
'AK44465200',
'AK44421300',
'AK44603300',
'AK44433300',
'AK44470400',
'AK44422400',
'AK44603400',
'AK44605400',
'AK44555400',
'AK44549400',
'AK44554500',
'AK44450600',
'AK44454800',
'AK44549800',
'AK44453010',
'AK44465010',
'AK44606010',
'AK44560110',
'AK44471110',
'AK44606110',
'AK44427110',
'AK44606310',
'AK44364410',
'AK44464410',
'AK44471510',
'AK44455610',
'AK44606610',
'AK44446610',
'AK44428610',
'AK44424710',
'AK44425710',
'AK43223810',
'AK44556810',
'AK44459810',
'AK44611120',
'AK44604120',
'AK44437120',
'AK44560220',
'AK44602220',
'AK44550320',
'AK44603320',
'AK44468420',
'AK44420520',
'AK44423520',
'AK44461620',
'AK44562620',
'AK44433620',
'AK44604620',
'AK44546620',
'AK44648620',
'AK44433720',
'AK44453720',
'AK44604720',
'AK44559720',
'AK44603920',
'AK44604920',
'AK44555920',
'AK44426920',
'AK44466920',
'AK44559920',
'AK44603030',
'AK44413030',
'AK44415130',
'AK44455230',
'AK44562330',
'AK44604430',
'AK44608430',
'AK44558530',
'AK44604630',
'AK44414730',
'AK44464730',
'AK44437730',
'AK44421830',
'AK44605930',
'AK44434140',
'AK44557140',
'AK44414340',
'AK44465440',
'AK44606440',
'AK44603540',
'AK44423540',
'AK44465640',
'AK44561740',
'AK44602740',
'AK44465840',
'AK42539840',
'AK43165940',
'AK44611050',
'AK44561050',
'AK44554050',
'AK44605050',
'AK44465050',
'AK44606050',
'AK44466050',
'AK44564150',
'AK44421450',
'AK44553450',
'AK44604450',
'AK44420550',
'AK44463550',
'AK44456550',
'AK44608550',
'AK44553650',
'AK44364650',
'AK44468750',
'AK44610950',
'AK44470060',
'AK44423060',
'AK44562160',
'AK44456160',
'AK44450260',
'AK44465260',
'AK44603360',
'AK44466360',
'AK44426460',
'AK44423560',
'AK44455560',
'AK44470660',
'AK44414660',
'AK44464660',
'AK44423760',
'AK44433760',
'AK44464760',
'AK44610070',
'AK44451070',
'AK44427070',
'AK44413170',
'AK44456170',
'AK43166170',
'AK44440270',
'AK44421270',
'AK44432370',
'AK44453370',
'AK44449370',
'AK44425570',
'AK44465570',
'AK44550670',
'AK44546670',
'AK44603770',
'AK44417770',
'AK44601870',
'AK44463970',
'AK44467970',
'AK44560280',
'AK44606280',
'AK44605380',
'AK44427380',
'AK44608380',
'AK44439380',
'AK44562480',
'AK44423480',
'AK44413580',
'AK44423580',
'AK44453580',
'AK44432780',
'AK44555780',
'AK44558780',
'AK44551880',
'AK44464880',
'AK44553980',
'AK44424980',
'AK44413090',
'AK44453090',
'AK44456090',
'AK44427090',
'AK44420190',
'AK44554290',
'AK44434390',
'AK44608390',
'AK44471490',
'AK44556490',
'AK44648490',
'AK44419490',
'AK44556590',
'AK44609590',
'AK44560690',
'AK44465690',
'AK44604790',
'AK44465790',
'AK44417790',
'AK44562890',
'AK44607890',
'AK44610990',
'AK44562990',
'AK44551001',
'AK44563001',
'AK44554001',
'AK44460101',
'AK44461101',
'AK44606201',
'AK44457201',
'AK44420301',
'AK44611301',
'AK44464301',
'AK44458301',
'AK44604401',
'AK44465401',
'AK44467401',
'AK44609501',
'AK44559601',
'AK44607701',
'AK44605801',
'AK44421901',
'AK44455011',
'AK44608111',
'AK44454311',
'AK44456311',
'AK44547411',
'AK44563511',
'AK44450611',
'AK44471611',
'AK44422611',
'AK44605611',
'AK44450711',
'AK44466711',
'AK44549711',
'AK44453021',
'AK44604021',
'AK44556121',
'AK44468121',
'AK44602221',
'AK44554221',
'AK44556221',
'AK44436321',
'AK44467321',
'AK44559321',
'AK44427521',
'AK44451621',
'AK44551621',
'AK44463621',
'AK44556621',
'AK44604721',
'AK44607721',
'AK44551031',
'AK44442131',
'AK44549131',
'AK44604231',
'AK44550331',
'AK44611331',
'AK44434431',
'AK44465431',
'AK44607431',
'AK44558431',
'AK44462531',
'AK44420631',
'AK44471631',
'AK44604631',
'AK44602731',
'AK44603731',
'AK44465731',
'AK44546731',
'AK44427731',
'AK44429731',
'AK44559731',
'AK44604931',
'AK44556931',
'AK44464041',
'AK44465141',
'AK44467141',
'AK44562241',
'AK44470341',
'AK44561341',
'AK44458341',
'AK44606441',
'AK44607541',
'AK44420641',
'AK44465741',
'AK44432841',
'AK44464841',
'AK44561941',
'AK44602941',
'AK44604941',
'AK44551151',
'AK44471151',
'AK44564151',
'AK44552351',
'AK44364351',
'AK44601451',
'AK44464451',
'AK44607451',
'AK44610551',
'AK44546551',
'AK44551651',
'AK44422651',
'AK43243751',
'AK44550951',
'AK44431161',
'AK44552161',
'AK44549161',
'AK44554261',
'AK44432361',
'AK44465461',
'AK44607461',
'AK44471561',
'AK44464561',
'AK44607561',
'AK44420661',
'AK44560761',
'AK44414761',
'AK44453071',
'AK44605171',
'AK44563271',
'AK44467271',
'AK44559271',
'AK44466371',
'AK44419371',
'AK44464471',
'AK44456471',
'AK44551571',
'AK44430671',
'AK44364671',
'AK44608671',
'AK44558671',
'AK44549671',
'AK44560771',
'AK44606771',
'AK44550871',
'AK44602871',
'AK44558871',
'AK44546971',
'AK44610181',
'AK44554181',
'AK44608281',
'AK44558281',
'AK44422381',
'AK44554381',
'AK44421481',
'AK44561481',
'AK44562481',
'AK44464581',
'AK44605581',
'AK44557581',
'AK44560681',
'AK44467681',
'AK44431781',
'AK44562781',
'AK44550881',
'AK44470881',
'AK44561881',
'AK44602881',
'AK44454881',
'AK44602981',
'AK44412981',
'AK44552981',
'AK44413091',
'AK44551191',
'AK44546191',
'AK44427191',
'AK44454291',
'AK44427291',
'AK44559291',
'AK44465391',
'AK44550491',
'AK44464491',
'AK44435491',
'AK44556491',
'AK44364591',
'AK44421791',
'AK44364891',
'AK44422991',
'AK44431002',
'AK44465002',
'AK44608002',
'AK44420102',
'AK44552102',
'AK44550202',
'AK44558302',
'AK44603402',
'AK44546402',
'AK44469402',
'AK44611502',
'AK44461502',
'AK44462502',
'AK44464502',
'AK44464602',
'AK44606602',
'AK44607702',
'AK44611802',
'AK44562902',
'AK44430012',
'AK44561012',
'AK44604012',
'AK44420112',
'AK44434112',
'AK44556112',
'AK44432212',
'AK44603312',
'AK44421412',
'AK44551412',
'AK44419412',
'AK44611512',
'AK44605612',
'AK44564712',
'AK44555712',
'AK44465712',
'AK44558712',
'AK44464812',
'AK43895812',
'AK44605912',
'AK44561022',
'AK44606022',
'AK44603122',
'AK44423122',
'AK44554222',
'AK44465222',
'AK44450322',
'AK44431422',
'AK44561422',
'AK44549422',
'AK44430522',
'AK44421522',
'AK44364522',
'AK44412622',
'AK44465622',
'AK44469622',
'AK44550722',
'AK44434722',
'AK44607722',
'AK44470922',
'AK44412922',
'AK44603032',
'AK44467032',
'AK44441132',
'AK44432132',
'AK44413132',
'AK43890232',
'AK44433232',
'AK44607232',
'AK44459232',
'AK44557332',
'AK44551432',
'AK44419432',
'AK44603532',
'AK44470732',
'AK44451732',
'AK44562832',
'AK44552932',
'AK44467932',
'AK44549932',
'AK44417042',
'AK44421142',
'AK44454142',
'AK44465242',
'AK44558242',
'AK44610342',
'AK44550442',
'AK44603442',
'AK44563542',
'AK44607542',
'AK44471642',
'AK44559642',
'AK44549742',
'AK44412842',
'AK44551942',
'AK44416942',
'AK44449942',
'AK44459942',
'AK44605052',
'AK44611152',
'AK44562152',
'AK44550252',
'AK44460252',
'AK44422252',
'AK44452252',
'AK44462252',
'AK44465252',
'AK44605352',
'AK44554452',
'AK44420552',
'AK44560552',
'AK44602552',
'AK44471652',
'AK44464652',
'AK44557652',
'AK44608652',
'AK44558652',
'AK44610752',
'AK44559752',
'AK43900852',
'AK44470852',
'AK44452852',
'AK44555852',
'AK44604952',
'AK44445952',
'AK44467952',
'AK44470062',
'AK44431062',
'AK44471162',
'AK44604162',
'AK44449162',
'AK44552362',
'AK44607362',
'AK44421462',
'AK44553462',
'AK44467462',
'AK44465562',
'AK44464662',
'AK44607662',
'AK44563762',
'AK44433862',
'AK44607862',
'AK44429862',
'AK44549862',
'AK44551962',
'AK44470072',
'AK44551172',
'AK44554172',
'AK44606172',
'AK44436272',
'AK44563372',
'AK43899472',
'AK44551572',
'AK43842772',
'AK44557772',
'AK44469772',
'AK44563872',
'AK44605872',
'AK44607972',
'AK44422082',
'AK44455082',
'AK44449082',
'AK44561182',
'AK44556282',
'AK44557382',
'AK44558382',
'AK44551482',
'AK44604482',
'AK44559482',
'AK44605582',
'AK44551682',
'AK44557782',
'AK44429782',
'AK44426882',
'AK44436882',
'AK44549882',
'AK44421982',
'AK44463982',
'AK44545982',
'AK44465092',
'AK44549092',
'AK44551192',
'AK44423192',
'AK44554192',
'AK44607192',
'AK44610292',
'AK43857292',
'AK44562392',
'AK44426392',
'AK44457392',
'AK44468392',
'AK44459392',
'AK44431592',
'AK44427592',
'AK44562692',
'AK44465692',
'AK44432792',
'AK44604792',
'AK44469792',
'AK44470892',
'AK43915892',
'AK43142003',
'AK44604003',
'AK44556003',
'AK44552103',
'AK44561203',
'AK44562203',
'AK44415203',
'AK44455203',
'AK44607203',
'AK44606303',
'AK44470403',
'AK44465403',
'AK44439403',
'AK44604703',
'AK44607703',
'AK44605803',
'AK44465803',
'AK44454903',
'AK44468903',
'AK43146013',
'AK44554113',
'AK44419113',
'AK44603213',
'AK44364213',
'AK44554313',
'AK44465313',
'AK44610413',
'AK44562513',
'AK44467513',
'AK44464613',
'AK44427713',
'AK44464813',
'AK44468913',
'AK44443023',
'AK44606023',
'AK44466023',
'AK44554223',
'AK44458323',
'AK44412623',
'AK44437623',
'AK44435723',
'AK44463823',
'AK44465823',
'AK44606823',
'AK44552923',
'AK44605923',
'AK44413033',
'AK44606033',
'AK44471133',
'AK44562133',
'AK44564133',
'AK44462333',
'AK44562333',
'AK43219333',
'AK44440433',
'AK44465433',
'AK44556433',
'AK44559433',
'AK44471533',
'AK43899533',
'AK44426633',
'AK44551733',
'AK44433733',
'AK44608733',
'AK44465833',
'AK44606833',
'AK44412933',
'AK44471143',
'AK44432143',
'AK44467143',
'AK44611243',
'AK44606243',
'AK44556243',
'AK44466243',
'AK44607243',
'AK44554343',
'AK44465343',
'AK44556343',
'AK44466343',
'AK44432443',
'AK44610543',
'AK44471543',
'AK44603643',
'AK44465843',
'AK44558843',
'AK44550943',
'AK44563943',
'AK44554053',
'AK44605053',
'AK44545153',
'AK44420253',
'AK44433253',
'AK44604253',
'AK44414253',
'AK44556253',
'AK44607253',
'AK44468253',
'AK44564353',
'AK44561453',
'AK44603453',
'AK44424453',
'AK44607453',
'AK43184553',
'AK44551653',
'AK44462653',
'AK44424753',
'AK44557853',
'AK44441953',
'AK44605953',
'AK44426953',
'AK44447953',
'AK44558953',
'AK44551163',
'AK44602163',
'AK44427163',
'AK44604363',
'AK44420463',
'AK44602463',
'AK44427463',
'AK44464563',
'AK44456763',
'AK44560863',
'AK44561863',
'AK44611073',
'AK43244073',
'AK44425073',
'AK44611173',
'AK44603173',
'AK44607173',
'AK44429173',
'AK44452273',
'AK44465273',
'AK44561373',
'AK44607373',
'AK44557373',
'AK44609373',
'AK44416573',
'AK44557673',
'AK44424773',
'AK44452873',
'AK44555873',
'AK44605973',
'AK44423083',
'AK44434083',
'AK44465283',
'AK44606283',
'AK44430383',
'AK44550383',
'AK44549383',
'AK44562583',
'AK44430683',
'AK44564783',
'AK44550883',
'AK44561883',
'AK44559883',
'AK44549983',
'AK44559983',
'AK44560293',
'AK44554293',
'AK44469293',
'AK44470393',
'AK44456393',
'AK44438393',
'AK44603493',
'AK44607493',
'AK44430693',
'AK43223693',
'AK44414793',
'AK44550893',
'AK44602893',
'AK44453893',
'AK44464893',
'AK44412993',
'AK44605993',
'AK44553104',
'AK44434104',
'AK44605104',
'AK44550204',
'AK44465204',
'AK44603304',
'AK44554304',
'AK44603404',
'AK44425404',
'AK43138404',
'AK44605604',
'AK44435704',
'AK44603804',
'AK44464804',
'AK44608804',
'AK44464904',
'AK44553014',
'AK44604014',
'AK44433114',
'AK44421214',
'AK44603214',
'AK44414214',
'AK44456214',
'AK44418214',
'AK44555314',
'AK44605414',
'AK44606414',
'AK43947514',
'AK44558514',
'AK44461614',
'AK44434614',
'AK43884814',
'AK44606814',
'AK44563914',
'AK44562024',
'AK44464124',
'AK44550224',
'AK44431224',
'AK44552224',
'AK44556224',
'AK43219224',
'AK44606324',
'AK44557324',
'AK44463424',
'AK44469424',
'AK44609524',
'AK44603624',
'AK44561724',
'AK43232724',
'AK44465724',
'AK43947824',
'AK44558824',
'AK44420034',
'AK44562034',
'AK44434034',
'AK44549034',
'AK44550134',
'AK44604134',
'AK44467134',
'AK44449134',
'AK44560234',
'AK44604234',
'AK44606234',
'AK44556234',
'AK44458234',
'AK44549334',
'AK44470434',
'AK44420534',
'AK44603534',
'AK44465534',
'AK44423634',
'AK44604634',
'AK44426634',
'AK44451734',
'AK44603734',
'AK44465734',
'AK44427734',
'AK44610834',
'AK44561834',
'AK44412834',
'AK44603834',
'AK44435044',
'AK44607044',
'AK44552144',
'AK44465144',
'AK44451244',
'AK44563244',
'AK44564244',
'AK44609244',
'AK44416344',
'AK44419344',
'AK44604444',
'AK44564444',
'AK44469444',
'AK44431544',
'AK44561544',
'AK44552544',
'AK44464544',
'AK44606744',
'AK44551844',
'AK44462844',
'AK44465844',
'AK44549844',
'AK43230944',
'AK44562944',
'AK44423054',
'AK44554054',
'AK44564054',
'AK44558054',
'AK44421254',
'AK44602254',
'AK44606254',
'AK44552354',
'AK44603354',
'AK44424354',
'AK44470454',
'AK44561454',
'AK43952454',
'AK44604454',
'AK44464454',
'AK44415454',
'AK44607454',
'AK44558454',
'AK44465654',
'AK44556654',
'AK44422754',
'AK44556754',
'AK44558754',
'AK44549754',
'AK44412854',
'AK44469854',
'AK44470954',
'AK44552954',
'AK44464954',
'AK44607954',
'AK44549954',
'AK44427064',
'AK44560164',
'AK44561164',
'AK44602164',
'AK44562164',
'AK44554164',
'AK44464164',
'AK44466164',
'AK44551464',
'AK44467464',
'AK44364564',
'AK44445564',
'AK44604664',
'AK44609664',
'AK44420864',
'AK44560864',
'AK44561864',
'AK44550964',
'AK44431074',
'AK44554074',
'AK44551174',
'AK44561174',
'AK44465174',
'AK44427174',
'AK44364274',
'AK44559274',
'AK44553374',
'AK44554374',
'AK44603474',
'AK43232574',
'AK44604574',
'AK44554574',
'AK44546574',
'AK44449574',
'AK44550874',
'AK44559874',
'AK44560974',
'AK44603084',
'AK44413184',
'AK44603284',
'AK44604284',
'AK44552384',
'AK44433384',
'AK43153384',
'AK44563384',
'AK44416484',
'AK44553584',
'AK44545584',
'AK44464784',
'AK44465784',
'AK44550884',
'AK44414884',
'AK44412984',
'AK44465094',
'AK44549094',
'AK44465194',
'AK44607194',
'AK44554294',
'AK43220394',
'AK44417394',
'AK44449394',
'AK44471494',
'AK44464494',
'AK44427494',
'AK44547494',
'AK43223594',
'AK44560794',
'AK44639794',
'AK44603894',
'AK44559894',
'AK44429994',
'AK44549994',
'AK44611105',
'AK44605105',
'AK44427105',
'AK44450205',
'AK44439205',
'AK44454305',
'AK44607305',
'AK44562405',
'AK44469405',
'AK44604605',
'AK44425605',
'AK44453705',
'AK44604705',
'AK44448705',
'AK44561805',
'AK44564805',
'AK44556805',
'AK44470905',
'AK44605905',
'AK44413015',
'AK44549015',
'AK44432115',
'AK44422215',
'AK44562215',
'AK44603215',
'AK44424215',
'AK44606315',
'AK44603415',
'AK44608415',
'AK44413515',
'AK43234515',
'AK44554615',
'AK44555615',
'AK44606615',
'AK44466615',
'AK44550715',
'AK44464915',
'AK44558915',
'AK44449915',
'AK44611025',
'AK44419125',
'AK44423225',
'AK44427225',
'AK44441325',
'AK44602325',
'AK44414325',
'AK44452425',
'AK44364425',
'AK44545425',
'AK44465525',
'AK44464625',
'AK44605625',
'AK44467625',
'AK44560725',
'AK44465825',
'AK44416825',
'AK44605925',
'AK44553035',
'AK44465035',
'AK44426035',
'AK44563135',
'AK44470235',
'AK44431235',
'AK44560335',
'AK44604335',
'AK44466335',
'AK44610435',
'AK44463435',
'AK44605435',
'AK44422535',
'AK44604635',
'AK44607635',
'AK44455735',
'AK44464835',
'AK44557835',
'AK44414935',
'AK44427935',
'AK44560045',
'AK44420145',
'AK44554145',
'AK44431245',
'AK44602245',
'AK44604245',
'AK44464245',
'AK44425245',
'AK44464345',
'AK44416345',
'AK44563545',
'AK44421645',
'AK44422645',
'AK44552645',
'AK44464645',
'AK44605645',
'AK44557645',
'AK44422845',
'AK44464845',
'AK44553945',
'AK44414945',
'AK44556945',
'AK44548945',
'AK44554055',
'AK44426055',
'AK44415155',
'AK44465155',
'AK44420255',
'AK44452255',
'AK44465255',
'AK44419255',
'AK44560355',
'AK44603355',
'AK44563355',
'AK44465355',
'AK44436355',
'AK44549355',
'AK44604455',
'AK44559455',
'AK44608655',
'AK44464855',
'AK44608955',
'AK44413065',
'AK44464165',
'AK44465165',
'AK44419265',
'AK44554365',
'AK44605365',
'AK44546365',
'AK44470465',
'AK44552465',
'AK44469465',
'AK44557565',
'AK44420665',
'AK44450665',
'AK44421665',
'AK44364665',
'AK44471765',
'AK44434765',
'AK44454765',
'AK44464965',
'AK44466965',
'AK44423175',
'AK44455175',
'AK44466175',
'AK44607175',
'AK44430275',
'AK44471275',
'AK44552275',
'AK44413275',
'AK44465275',
'AK44441375',
'AK44605375',
'AK43897375',
'AK44603475',
'AK44423475',
'AK44468575',
'AK44551775',
'AK44414775',
'AK44607775',
'AK44608775',
'AK44560875',
'AK44422875',
'AK44604875',
'AK44544875',
'AK44469875',
'AK44412975',
'AK44433975',
'AK44604975',
'AK43916085',
'AK43148085',
'AK44550185',
'AK44551185',
'AK44471185',
'AK44562185',
'AK44603185',
'AK44463185',
'AK44434185',
'AK44425185',
'AK44605385',
'AK44431485',
'AK43239485',
'AK44420585',
'AK44423585',
'AK44427585',
'AK44364685',
'AK44425785',
'AK44609785',
'AK44420885',
'AK44604885',
'AK44549885',
'AK44602985',
'AK44453095',
'AK44427095',
'AK44465195',
'AK44609195',
'AK44604295',
'AK44425395',
'AK44416495',
'AK44561895',
'AK44422895',
'AK44423895',
'AK44433895',
'AK44415895',
'AK44546895',
'AK44602995',
'AK44425995',
'AK44467995',
'AK44420006',
'AK44470106',
'AK44451106',
'AK44649106',
'AK44552206',
'AK44547406',
'AK44464506',
'AK44609606',
'AK44557706',
'AK44452806',
'AK44603806',
'AK44560906',
'AK44464016',
'AK44465016',
'AK44560116',
'AK44602216',
'AK44603216',
'AK44458316',
'AK44549316',
'AK44604416',
'AK44554416',
'AK44559416',
'AK44605616',
'AK44426616',
'AK44422716',
'AK44465716',
'AK44606816',
'AK44470916',
'AK44433026',
'AK44365026',
'AK44607026',
'AK44560226',
'AK44470326',
'AK44605326',
'AK44456326',
'AK44562426',
'AK44427426',
'AK44419426',
'AK44464526',
'AK44465526',
'AK44416526',
'AK44556626',
'AK44550726',
'AK44413726',
'AK44427726',
'AK44606826',
'AK44464926',
'AK44554036',
'AK44607036',
'AK44422136',
'AK44556236',
'AK44413436',
'AK44364436',
'AK44465536',
'AK44604636',
'AK44607636',
'AK44608636',
'AK44609736',
'AK44460836',
'AK44412836',
'AK44452836',
'AK44470936',
'AK44602936',
'AK44605936',
'AK44468936',
'AK44430046',
'AK44552146',
'AK44564246',
'AK44609246',
'AK44364346',
'AK44465346',
'AK44456346',
'AK44449346',
'AK44471446',
'AK44563446',
'AK44604446',
'AK44465446',
'AK44608446',
'AK44549446',
'AK44422546',
'AK44604546',
'AK44606546',
'AK44414646',
'AK44464646',
'AK44425646',
'AK44456646',
'AK44469646',
'AK44470746',
'AK44456846',
'AK44466846',
'AK44607846',
'AK44549846',
'AK44469846',
'AK44430056',
'AK44550056',
'AK44431056',
'AK44413056',
'AK44605056',
'AK44417056',
'AK44470156',
'AK44442156',
'AK44464156',
'AK44468156',
'AK44449156',
'AK44421256',
'AK44603256',
'AK44555256',
'AK44564356',
'AK44469456',
'AK44551556',
'AK43909556',
'AK44420656',
'AK44432656',
'AK44464656',
'AK44465756',
'AK44413856',
'AK44468856',
'AK44560956',
'AK44435956',
'AK44426956',
'AK44607956',
'AK44602066',
'AK44564066',
'AK44466066',
'AK44610166',
'AK44465166',
'AK43152366',
'AK44439366',
'AK44470466',
'AK44601466',
'AK44555466',
'AK44416466',
'AK44545566',
'AK44559666',
'AK44549766',
'AK44550866',
'AK44412866',
'AK44428866',
'AK44464966',
'AK44554076',
'AK44427076',
'AK44549076',
'AK44450176',
'AK44560276',
'AK44458276',
'AK44560476',
'AK43232476',
'AK44463476',
'AK44467476',
'AK44609476',
'AK44469476',
'AK44418676',
'AK44467776',
'AK44557876',
'AK44470976',
'AK44414976',
'AK44611086',
'AK44467086',
'AK44605186',
'AK44469186',
'AK44563286',
'AK44605286',
'AK44608386',
'AK44467586',
'AK44420786',
'AK44564786',
'AK44416886',
'AK44562986',
'AK44428986',
'AK44603096',
'AK44463096',
'AK44606196',
'AK44607196',
'AK44421296',
'AK44464296',
'AK44469296',
'AK44470396',
'AK44421396',
'AK44422396',
'AK44551496',
'AK44428496',
'AK44546596',
'AK44412696',
'AK44455796',
'AK44466796',
'AK44610896',
'AK44562896',
'AK44603896',
'AK44607007',
'AK44549007',
'AK44606207',
'AK43868207',
'AK44606307',
'AK44554407',
'AK44456407',
'AK44465507',
'AK44606507',
'AK44607607',
'AK44432707',
'AK44364707',
'AK44564807',
'AK44465807',
'AK44431907',
'AK44563907',
'AK44558907',
'AK44468907',
'AK44549907',
'AK44553017',
'AK44609017',
'AK44465117',
'AK44607117',
'AK44610217',
'AK44425217',
'AK44607217',
'AK44469317',
'AK44431517',
'AK44563517',
'AK44648517',
'AK44551617',
'AK44603617',
'AK44413617',
'AK44423617',
'AK44604617',
'AK44415617',
'AK44420817',
'AK44434817',
'AK44412917',
'AK44464917',
'AK44605917',
'AK44560027',
'AK44605027',
'AK44457027',
'AK44611127',
'AK44451127',
'AK44563127',
'AK44466127',
'AK44549127',
'AK44611227',
'AK44552227',
'AK44550327',
'AK44552327',
'AK44449327',
'AK44430527',
'AK44648527',
'AK44607627',
'AK44421727',
'AK44603727',
'AK44563727',
'AK44607727',
'AK44562827',
'AK44563827',
'AK44464827',
'AK44416827',
'AK44561927',
'AK44433927',
'AK44418927',
'AK44467037',
'AK44422237',
'AK44562237',
'AK44455237',
'AK44450337',
'AK43184337',
'AK44417337',
'AK44421437',
'AK44602437',
'AK44552537',
'AK44603537',
'AK44554637',
'AK44559637',
'AK44603737',
'AK44420837',
'AK44602837',
'AK44464837',
'AK44420937',
'AK44606047',
'AK44433147',
'AK44419147',
'AK44551247',
'AK44552247',
'AK44453247',
'AK44557247',
'AK44550347',
'AK44461347',
'AK44434347',
'AK44465347',
'AK44552547',
'AK44607547',
'AK44462647',
'AK44563647',
'AK44564647',
'AK44558747',
'AK44424847',
'AK44453947',
'AK44441057',
'AK44554057',
'AK44464057',
'AK44609057',
'AK44427157',
'AK44457157',
'AK44423257',
'AK44606257',
'AK44603357',
'AK44564357',
'AK44605357',
'AK43232457',
'AK44604457',
'AK44554457',
'AK44456457',
'AK44560557',
'AK44551657',
'AK44471657',
'AK44465657',
'AK44428657',
'AK44607757',
'AK44557757',
'AK44464857',
'AK44556957',
'AK44467957',
'AK44558957',
'AK44453067',
'AK44436067',
'AK44456067',
'AK44549067',
'AK44562167',
'AK44561267',
'AK44423367',
'AK44424367',
'AK44464367',
'AK44467367',
'AK44606467',
'AK44607467',
'AK44459467',
'AK44450567',
'AK44606567',
'AK44425667',
'AK44555767',
'AK44412867',
'AK44430967',
'AK44470077',
'AK44605077',
'AK44611177',
'AK44603177',
'AK44433277',
'AK44458277',
'AK44470377',
'AK44466377',
'AK44552477',
'AK44553477',
'AK44551577',
'AK44465677',
'AK44550777',
'AK44561777',
'AK44464777',
'AK44560877',
'AK44436977',
'AK44607977',
'AK44450187',
'AK44422187',
'AK44607187',
'AK44429187',
'AK44471287',
'AK44434287',
'AK40686387',
'AK44426487',
'AK44607487',
'AK44430587',
'AK44465587',
'AK44607587',
'AK44554687',
'AK44546687',
'AK44467687',
'AK44469687',
'AK44552787',
'AK44456787',
'AK44466787',
'AK44557787',
'AK44559787',
'AK44561887',
'AK44412987',
'AK44455987',
'AK44414097',
'AK44415097',
'AK44436097',
'AK44421197',
'AK44559197',
'AK44471297',
'AK44550397',
'AK44605397',
'AK44465397',
'AK44442597',
'AK44465597',
'AK44563697',
'AK44605697',
'AK44607697',
'AK44417697',
'AK44427697',
'AK44421797',
'AK44464897',
'AK44605997',
'AK44608008',
'AK44434108',
'AK44560208',
'AK44551308',
'AK44455308',
'AK44431408',
'AK44465408',
'AK44429408',
'AK44416508',
'AK44450608',
'AK44607608',
'AK44469608',
'AK44604708',
'AK44416708',
'AK44550118',
'AK44422118',
'AK44454118',
'AK44564118',
'AK44551218',
'AK44610318',
'AK44564318',
'AK44561418',
'AK44464418',
'AK44427418',
'AK44424518',
'AK44609518',
'AK44463618',
'AK44465718',
'AK44560818',
'AK44423818',
'AK44450918',
'AK44603918',
'AK44414918',
'AK44605128',
'AK44465128',
'AK44418228',
'AK43232328',
'AK44549328',
'AK44433528',
'AK44564528',
'AK44465528',
'AK44469528',
'AK44450628',
'AK44558628',
'AK44429728',
'AK44555828',
'AK44463928',
'AK44424928',
'AK44471038',
'AK44605038',
'AK44549138',
'AK44560238',
'AK44552238',
'AK44559238',
'AK44456338',
'AK44557338',
'AK44556438',
'AK44364538',
'AK44437538',
'AK44604638',
'AK44464638',
'AK44465638',
'AK44608638',
'AK44412738',
'AK44465738',
'AK44427738',
'AK44449738',
'AK44549738',
'AK44559738',
'AK44464838',
'AK44467838',
'AK44549838',
'AK44420938',
'AK44602938',
'AK44563048',
'AK44605048',
'AK44556048',
'AK44416148',
'AK44469148',
'AK44465248',
'AK44436248',
'AK44559348',
'AK44603448',
'AK44553448',
'AK44604448',
'AK44465448',
'AK44430548',
'AK44465548',
'AK44436548',
'AK44468548',
'AK44422648',
'AK44414648',
'AK44364648',
'AK44550748',
'AK44552748',
'AK44606748',
'AK44552848',
'AK44464848',
'AK43897848',
'AK44609058',
'AK44435258',
'AK44554358',
'AK44559358',
'AK44560658',
'AK44412658',
'AK44604658',
'AK44557658',
'AK44422758',
'AK44606758',
'AK44459758',
'AK44454858',
'AK44418958',
'AK44457068',
'AK44611168',
'AK44421168',
'AK44552168',
'AK44554168',
'AK44452268',
'AK44435268',
'AK44602368',
'AK44604368',
'AK44430468',
'AK44419468',
'AK44562568',
'AK44554568',
'AK44465568',
'AK44412668',
'AK44456668',
'AK44604868',
'AK44464968',
'AK44554078',
'AK44415178',
'AK44546178',
'AK44469178',
'AK44560278',
'AK44451378',
'AK44422378',
'AK44564378',
'AK44427378',
'AK44455478',
'AK44607478',
'AK44464578',
'AK44552678',
'AK44468678',
'AK44413778',
'AK44469778',
'AK44550878',
'AK44561978',
'AK44602978',
'AK44604978',
'AK44435978',
'AK44464088',
'AK44435088',
'AK44456088',
'AK44414188',
'AK44554188',
'AK44562288',
'AK44610388',
'AK44430488',
'AK44450488',
'AK44607488',
'AK44423588',
'AK44465588',
'AK44421688',
'AK44364688',
'AK44416688',
'AK44412788',
'AK44425788',
'AK44464888',
'AK44466888',
'AK44450988',
'AK44364988',
'AK44416988',
'AK44609988',
'AK44556098',
'AK43138098',
'AK44605198',
'AK44545198',
'AK44465198',
'AK44604298',
'AK44602398',
'AK44603398',
'AK44451498',
'AK44648498',
'AK44425598',
'AK44551698',
'AK44424798',
'AK44465798',
'AK44426798',
'AK44561898',
'AK44552898',
'AK44424998',
'AK44364998',
'AK44549998',
'AK44611009',
'AK44432009',
'AK44563009',
'AK44455009',
'AK44606009',
'AK44430109',
'AK44560109',
'AK44423109',
'AK44605109',
'AK44606109',
'AK44456109',
'AK44422209',
'AK44556209',
'AK44364309',
'AK42535309',
'AK44426309',
'AK44551409',
'AK44564409',
'AK44648409',
'AK44464509',
'AK44609509',
'AK44430609',
'AK44425609',
'AK44465709',
'AK44433809',
'AK44544809',
'AK44561909',
'AK43898909',
'AK44463019',
'AK44604019',
'AK44464019',
'AK44465019',
'AK44439019',
'AK44414119',
'AK44435119',
'AK44557119',
'AK44602219',
'AK44556219',
'AK44549419',
'AK44464519',
'AK44465519',
'AK44610719',
'AK44604719',
'AK44564719',
'AK44425819',
'AK44463919',
'AK44464919',
'AK44461029',
'AK44465029',
'AK44558029',
'AK44560129',
'AK44432129',
'AK44465229',
'AK44469229',
'AK44427329',
'AK44550429',
'AK43914429',
'AK44558429',
'AK44442529',
'AK44563529',
'AK44464529',
'AK44561729',
'AK44456729',
'AK44608729',
'AK44469729',
'AK44465829',
'AK44604929',
'AK44562039',
'AK44463039',
'AK44563039',
'AK44464039',
'AK44432139',
'AK43845139',
'AK44558139',
'AK44450239',
'AK44435239',
'AK44438239',
'AK44649239',
'AK44560339',
'AK44604339',
'AK44427339',
'AK44609339',
'AK44550439',
'AK44547439',
'AK44552539',
'AK44412639',
'AK44554639',
'AK44607639',
'AK44559739',
'AK44412839',
'AK44422939',
'AK44552939',
'AK44554049',
'AK44606049',
'AK44426049',
'AK44560149',
'AK44423149',
'AK44464149',
'AK44364349',
'AK44465349',
'AK44607449',
'AK44558649',
'AK44550749',
'AK44414749',
'AK44434749',
'AK44465749',
'AK44438749',
'AK44544949',
'AK44548949',
'AK44605059',
'AK44456059',
'AK44420159',
'AK44551159',
'AK44419159',
'AK44422259',
'AK44556259',
'AK44430359',
'AK44429359',
'AK44546459',
'AK44451559',
'AK44551559',
'AK44463559',
'AK44464659',
'AK44455659',
'AK44561759',
'AK44471759',
'AK44454759',
'AK43916859',
'AK44426959',
'AK44438069',
'AK42540169',
'AK44560269',
'AK44548469',
'AK43231569',
'AK44604569',
'AK44465569',
'AK44556569',
'AK44416669',
'AK44551869',
'AK44545969',
'AK44471179',
'AK44603179',
'AK44605179',
'AK44426179',
'AK44422279',
'AK44564379',
'AK44545379',
'AK44607379',
'AK44603479',
'AK44364479',
'AK44558479',
'AK44440579',
'AK43426679',
'AK44561779',
'AK44462779',
'AK44423779',
'AK44464779',
'AK44561879',
'AK44602979',
'AK44414979',
'AK44449979',
'AK44413089',
'AK44605089',
'AK44551189',
'AK44554189',
'AK44545189',
'AK44607189',
'AK44462289',
'AK44605389',
'AK44456389',
'AK44610489',
'AK44603489',
'AK43906489',
'AK44427489',
'AK44551589',
'AK44604589',
'AK44465589',
'AK44610789',
'AK44471789',
'AK44608789',
'AK44604889',
'AK44412989',
'AK44554099',
'AK44464199',
'AK44608199',
'AK44461299',
'AK44422299',
'AK44554299',
'AK44606299',
'AK44556299',
'AK44554399',
'AK44606399',
'AK44609399',
'AK44562499',
'AK44464499',
'AK44458499',
'AK44469499',
'AK44604699',
'AK44470799',
'AK44412799',
'AK44610999',
'AK44449999',
            );

            // キャンセル理由の定義
            $reason = '';
            $reasonCode = 8;
            // <-------------------------------------------------------------------------

            $logic = new LogicCancel($this->dbAdapter);

            // 対象データ分ループ
            foreach ($target as $orderId) {
                // $this->logger->info('[' . $orderId . '] Start ');

                // 注文SEQを特定する
                $sql = ' SELECT * FROM T_Order WHERE OrderId = :OrderId ';
                $prm = array(
                    ':OrderId' => $orderId,
                );

                $row = $this->dbAdapter->query($sql)->execute($prm)->current();

                if (!$row) {
                    // 特定できない場合はアラート出力⇒次の行へ
                    $this->logger->warn('<CancelRegister> [' . $orderId . '] OrderId Is Not Found!!');
                    continue;
                }

                // 注文SEQ特定
                $oseq = $row['OrderSeq'];

                // キャンセル申請処理を行う
                try {
                    $logic->applies($oseq, $reason, $reasonCode, 1, false, $userId);
                    $this->logger->info('<CancelRegister> [' . $orderId . '] Complete!! ');
                } catch(OrderCancelException $oce) {
                    $this->logger->warn('<CancelRegister> [' . $orderId . '] Order Is Not Cancel Message = ' . $oce->getMessage());
                    $this->logger->warn('<CancelRegister> [' . $orderId . '] ' . $oce->getTraceAsString());
                }

            }

            // $this->dbAdapter->getDriver()->getConnection()->rollback();
            $this->dbAdapter->getDriver()->getConnection()->commit();

            $exitCode = 0; // 正常終了
$this->logger->info('_data_patch_20200610_2000_CancelRegister.php end');

        } catch( \Exception $e ) {
            try{
                $this->dbAdapter->getDriver()->getConnection()->rollback();
            } catch ( \Exception $err) { }

            // エラーログを出力
            if ( isset($this->logger) ) {
$this->logger->err('<CancelRegister> ' . $e->getMessage());
$this->logger->err('<CancelRegister> ' . $e->getTraceAsString());
            }
        }

        // 終了コードを指定して処理終了
        exit($exitCode);

    }
}

Application::getInstance()->run();
